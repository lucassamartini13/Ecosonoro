<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>EcoSonoro: Gestor Urbano</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #00d2ff;
            --secondary: #3a7bd5;
            --success: #00b894;
            --warning: #fdcb6e;
            --danger: #d63031;
            --bg: #0f172a;
            --card: #1e293b;
            --text: #f8fafc;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Montserrat', sans-serif; user-select: none; }
        body { background-color: var(--bg); color: var(--text); overflow: hidden; touch-action: none; }

        #game-container { width: 100vw; height: 100vh; display: flex; flex-direction: column; position: relative; }

        /* HUD */
        header {
            padding: 15px;
            background: rgba(15, 23, 42, 0.9);
            backdrop-filter: blur(10px);
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            z-index: 100;
        }

        .time-box { text-align: center; }
        .time-label { font-size: 10px; color: var(--primary); text-transform: uppercase; font-weight: 700; }
        .time-value { font-weight: 900; font-size: 20px; }

        .survival-box { text-align: right; }
        .survival-label { font-size: 10px; color: var(--success); text-transform: uppercase; font-weight: 700; }
        .survival-value { font-weight: 900; font-size: 20px; }

        /* Map Area */
        #map-area {
            flex-grow: 1;
            position: relative;
            display: grid;
            grid-template-areas: 
                "norte norte norte"
                "oeste centro leste"
                "sul sul sul";
            grid-template-rows: 1fr 1.2fr 1fr;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 10px;
            padding: 10px;
            background: #020617;
        }

        .region {
            position: relative;
            background: var(--card);
            border-radius: 15px;
            border: 2px solid rgba(255,255,255,0.05);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            transition: all 0.3s;
            overflow: hidden;
            cursor: pointer;
        }

        .region.active-event { border-color: var(--warning); animation: pulse-warning 1.5s infinite; }
        .region.critical { border-color: var(--danger); animation: pulse-danger 1s infinite; }

        @keyframes pulse-warning { 0% { box-shadow: inset 0 0 0px var(--warning); } 50% { box-shadow: inset 0 0 20px var(--warning); } 100% { box-shadow: inset 0 0 0px var(--warning); } }
        @keyframes pulse-danger { 0% { box-shadow: inset 0 0 0px var(--danger); } 50% { box-shadow: inset 0 0 30px var(--danger); } 100% { box-shadow: inset 0 0 0px var(--danger); } }

        .region-icon { font-size: 30px; margin-bottom: 5px; opacity: 0.7; }
        .region-name { font-size: 12px; font-weight: 900; text-transform: uppercase; letter-spacing: 1px; color: rgba(255,255,255,0.5); }

        .db-bar-container {
            width: 80%;
            height: 6px;
            background: rgba(0,0,0,0.3);
            border-radius: 3px;
            margin-top: 10px;
            overflow: hidden;
        }
        .db-bar-fill { height: 100%; width: 0%; background: var(--success); transition: width 0.3s, background 0.3s; }

        .event-marker {
            position: absolute;
            top: 10px; right: 10px;
            width: 12px; height: 12px;
            background: var(--danger);
            border-radius: 50%;
            display: none;
            animation: blink 0.5s infinite;
        }
        @keyframes blink { 0% { opacity: 1; } 50% { opacity: 0; } 100% { opacity: 1; } }

        /* Grid Assignment */
        #norte { grid-area: norte; }
        #sul { grid-area: sul; }
        #leste { grid-area: leste; }
        #oeste { grid-area: oeste; }
        #centro { grid-area: centro; }

        /* Quiz Modal */
        #quiz-overlay {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(15, 23, 42, 0.95);
            display: none; flex-direction: column; justify-content: center; align-items: center;
            z-index: 500; padding: 30px; text-align: center;
        }
        #quiz-container {
            background: #fff; color: #1e293b; padding: 30px; border-radius: 25px;
            width: 100%; max-width: 400px; box-shadow: 0 20px 40px rgba(0,0,0,0.5);
        }
        #quiz-question { font-size: 18px; font-weight: 700; margin-bottom: 20px; line-height: 1.4; }
        .quiz-option {
            display: block; width: 100%; padding: 15px; margin: 10px 0;
            border: 2px solid #e2e8f0; border-radius: 12px; font-weight: 700;
            cursor: pointer; transition: all 0.2s; font-size: 14px;
        }
        .quiz-option:active { transform: scale(0.98); background: #f1f5f9; }

        /* Screens */
        .screen-overlay {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            background: var(--bg); z-index: 1000; padding: 40px; text-align: center;
        }
        .btn-main {
            padding: 20px 50px; background: linear-gradient(to right, #00d2ff, #3a7bd5); color: white;
            border: none; border-radius: 40px; font-size: 18px; font-weight: 900;
            cursor: pointer; box-shadow: 0 10px 20px rgba(58, 123, 213, 0.3);
        }
    </style>
</head>
<body>

<div id="game-container">
    <header>
        <div class="time-box">
            <div class="time-label">Hor√°rio</div>
            <div id="clock-val" class="time-value">08:00</div>
            <div id="period-val" style="font-size: 9px; text-transform: uppercase; opacity: 0.7; font-weight: 700; text-align: center; margin-top: 2px; color: var(--primary);">Manh√£</div>
        </div>
        <div style="text-align: center;">
            <div style="font-size: 12px; font-weight: 900; color: var(--primary);">ECOSONORO</div>
            <div style="font-size: 8px; letter-spacing: 2px; opacity: 0.5;">GESTOR URBANO</div>
        </div>
        <div class="stat-box" style="text-align: center; min-width: 100px;">
            <div style="font-size: 10px; color: #ff7675; text-transform: uppercase; font-weight: 700;">Satisfa√ß√£o</div>
            <div id="satisfaction-val" style="font-weight: 900; font-size: 20px; color: #fff;">80%</div>
            <div style="width: 100%; height: 4px; background: rgba(255,255,255,0.1); border-radius: 2px; margin-top: 4px; overflow: hidden;">
                <div id="satisfaction-fill" style="height: 100%; width: 80%; background: var(--success); transition: width 0.3s;"></div>
            </div>
        </div>
        <div class="survival-box">
            <div class="survival-label">Sobreviv√™ncia</div>
            <div id="days-val" class="survival-value">Dia 1</div>
        </div>
    </header>

    <div id="map-area">
        <div id="norte" class="region" onclick="handleRegionClick('norte')">
            <div class="region-icon">üè≠</div>
            <div class="region-name">Norte (Industrial)</div>
            <div class="db-bar-container"><div id="db-norte" class="db-bar-fill"></div></div>
            <div id="marker-norte" class="event-marker"></div>
        </div>
        <div id="oeste" class="region" onclick="handleRegionClick('oeste')">
            <div class="region-icon">üè†</div>
            <div class="region-name">Oeste (Residencial)</div>
            <div class="db-bar-container"><div id="db-oeste" class="db-bar-fill"></div></div>
            <div id="marker-oeste" class="event-marker"></div>
        </div>
        <div id="centro" class="region" onclick="handleRegionClick('centro')">
            <div class="region-icon">üèôÔ∏è</div>
            <div class="region-name">Centro (Comercial)</div>
            <div class="db-bar-container"><div id="db-centro" class="db-bar-fill"></div></div>
            <div id="marker-centro" class="event-marker"></div>
        </div>
        <div id="leste" class="region" onclick="handleRegionClick('leste')">
            <div class="region-icon">üè•</div>
            <div class="region-name">Leste (Hospitalar)</div>
            <div class="db-bar-container"><div id="db-leste" class="db-bar-fill"></div></div>
            <div id="marker-leste" class="event-marker"></div>
        </div>
        <div id="sul" class="region" onclick="handleRegionClick('sul')">
            <div class="region-icon">üå≥</div>
            <div class="region-name">Sul (Lazer/Parques)</div>
            <div class="db-bar-container"><div id="db-sul" class="db-bar-fill"></div></div>
            <div id="marker-sul" class="event-marker"></div>
        </div>
    </div>

    <div id="quiz-overlay">
        <div id="quiz-container">
            <div id="quiz-question">Pergunta?</div>
            <div id="quiz-options"></div>
        </div>
    </div>

    <div id="start-screen" class="screen-overlay">
        <h1 style="font-size: 40px; font-weight: 900; margin-bottom: 10px;">EcoSonoro</h1>
        <p style="color: #94a3b8; margin-bottom: 30px; max-width: 300px;">
            Gerencie o ru√≠do de 5 regi√µes urbanas. <br>
            Resolva quizzes para manter a paz. <br>
            <b>Quanto tempo voc√™ sobrevive?</b>
        </p>
        <button class="btn-main" onclick="startGame()">INICIAR SIMULA√á√ÉO</button>
    </div>

    <div id="end-screen" class="screen-overlay" style="display: none;">
        <h1 style="font-size: 36px; color: var(--danger); margin-bottom: 10px;">CIDADE EM CAOS</h1>
        <p id="end-reason" style="color: #94a3b8; margin-bottom: 30px;"></p>
        <div style="background: rgba(255,255,255,0.05); padding: 20px; border-radius: 20px; margin-bottom: 30px;">
            <div id="final-days" style="font-size: 24px; font-weight: 900;">Dia 1</div>
            <div style="font-size: 12px; opacity: 0.5;">TEMPO DE GEST√ÉO</div>
        </div>
        <button class="btn-main" onclick="location.reload()">RECOME√áAR</button>
    </div>
</div>

<script>
    // Configura√ß√µes
    const HOUR_DURATION = 1200; // 1 hora = 1.2 segundos
    const EVENT_DURATION = 4; // 4 horas de jogo
    const MAX_DB_INCREASE = 10; // M√°ximo de 10dB acima da base por problema
    const DEFEAT_THRESHOLD = 20; // Perde se dB > BASE + 20 (Extremo)

    // Limites OMS aproximados (dB)
    const OMS_LIMITS = {
        norte: 70,  // Industrial
        oeste: 50,  // Residencial
        centro: 65, // Comercial
        leste: 45,  // Hospitalar
        sul: 55     // Lazer
    };

    let state = {
        gameActive: false,
        hours: 8,
        minutes: 0,
        days: 1,
        satisfaction: 80,
        regions: {
            norte: { base: 70, db: 70, event: null, eventTime: 0, targetDb: 70, quizAttempted: false, eventPeriod: null },
            oeste: { base: 50, db: 50, event: null, eventTime: 0, targetDb: 50, quizAttempted: false, eventPeriod: null },
            centro: { base: 65, db: 65, event: null, eventTime: 0, targetDb: 65, quizAttempted: false, eventPeriod: null },
            leste: { base: 45, db: 45, event: null, eventTime: 0, targetDb: 45, quizAttempted: false, eventPeriod: null },
            sul: { base: 55, db: 55, event: null, eventTime: 0, targetDb: 55, quizAttempted: false, eventPeriod: null }
        },
        quizActive: false,
        activeRegionId: null
    };

    const QUIZZES = {
        norte: [
            { q: "Trem de carga passando com ru√≠do excessivo nos trilhos. Solu√ß√£o?", a: ["Lubrifica√ß√£o de trilhos e barreiras", "Aumentar a velocidade do trem", "Pintar os vag√µes"], correct: 0, times: ["dawn", "morning", "afternoon", "night"] },
            { q: "Sirene de aviso de turno soando muito alto e longo. A√ß√£o?", a: ["Ajustar volume e usar alertas visuais", "Remover a sirene totalmente", "Dobrar o tempo da sirene"], correct: 0, times: ["dawn", "morning", "afternoon", "night"] },
            { q: "Ru√≠do met√°lico constante de prensas industriais. Solu√ß√£o?", a: ["Enclausuramento ac√∫stico das m√°quinas", "Desligar as m√°quinas ao meio-dia", "Aumentar o p√© direito do galp√£o"], correct: 0, times: ["dawn", "morning", "afternoon", "night"] }
        ],
        oeste: [
            { q: "Corrida clandestina de motos na madrugada.", a: ["Policiamento nas vias", "Quebra-molas de borracha e radares", "Promover corridas legalizadas"], impacts: [ {db: -7, sat: 21}, {db: -12, sat: -15}, {db: 8, sat: -10} ], times: ["dawn"] },
            { q: "Caixa de som alto em resid√™ncia de vizinho (Madrugada).", a: ["Confiscar a caixa e aplicar multa", "Prender os vizinhos", "Ignorar"], impacts: [ {db: -6, sat: 8}, {db: -10, sat: -15}, {db: 8, sat: -10} ], times: ["dawn"] },
            { q: "Gritos na vizinhan√ßa durante a manh√£.", a: ["Multar as pessoas", "Campanha de conscientiza√ß√£o", "Agentes gritarem por sil√™ncio"], impacts: [ {db: -3, sat: -5}, {db: -5, sat: 7}, {db: 6, sat: -10} ], times: ["morning"] },
            { q: "Som de buzina no tr√¢nsito matinal.", a: ["Aumentar sem√°foros", "Rotat√≥rias e m√£o √∫nica", "Multar carros buzinando"], impacts: [ {db: 15, sat: -25}, {db: -8, sat: 25}, {db: -4, sat: 2} ], times: ["morning"] },
            { q: "Motos com escapamento adulterado (Manh√£).", a: ["Prender condutor e apreender moto", "Competi√ß√£o de moto barulhenta", "Campanha e multas"], impacts: [ {db: -8, sat: 5}, {db: 16, sat: -10}, {db: -8, sat: 20} ], times: ["morning"] },
            { q: "Motos com escapamento adulterado (Tarde).", a: ["Prender condutor e apreender moto", "Competi√ß√£o de moto barulhenta", "Campanha e multas"], impacts: [ {db: -8, sat: 5}, {db: 16, sat: -10}, {db: -8, sat: 20} ], times: ["afternoon"] },
            { q: "Som de buzina no tr√¢nsito √† tarde.", a: ["Aumentar sem√°foros", "Rotat√≥rias e m√£o √∫nica", "Multar carros buzinando"], impacts: [ {db: 15, sat: -25}, {db: -8, sat: 25}, {db: -4, sat: 2} ], times: ["afternoon"] },
            { q: "Obras fazendo muito barulho perto de resid√™ncias.", a: ["Interromper obra indefinidamente", "Reduzir tempo de obra por dia", "Planejamento e barreiras ac√∫sticas"], impacts: [ {db: -8, sat: -20}, {db: 2, sat: -10}, {db: -5, sat: 8} ], times: ["afternoon"] },
            { q: "Vizinhos soltando fogos de artif√≠cio.", a: ["Ignorar e deixar festejar", "Proibir venda e multar", "Prender quem solta fogos"], impacts: [ {db: 4, sat: -10}, {db: -10, sat: 8}, {db: -14, sat: -5} ], times: ["night"] },
            { q: "Caixa de som alto em resid√™ncia de vizinho (Noite).", a: ["Confiscar a caixa e aplicar multa", "Prender os vizinhos", "Ignorar"], impacts: [ {db: -6, sat: 8}, {db: -10, sat: -15}, {db: 8, sat: -10} ], times: ["night"] }
        ],
        centro: [
            { q: "Tarde: Carro de publicidade com volume abusivo. Solu√ß√£o?", a: ["Regulamentar volume e hor√°rios", "Proibir publicidade m√≥vel", "Aumentar o som para competir"], correct: 0, times: ["afternoon"] },
            { q: "Manh√£: Lojistas com caixas de som na cal√ßada. A√ß√£o?", a: ["Fiscaliza√ß√£o e apreens√£o de caixas", "Permitir apenas m√∫sica calma", "Aumentar o IPTU comercial"], correct: 0, times: ["morning", "afternoon"] },
            { q: "Tarde: Gritos de promotores de vendas no cal√ßad√£o. Solu√ß√£o?", a: ["Proibir uso de megafones", "Contratar mais promotores", "Instalar caixas de som p√∫blicas"], correct: 0, times: ["morning", "afternoon"] },
            { q: "Manh√£: Buzinas excessivas em congestionamento. A√ß√£o?", a: ["Agentes de tr√¢nsito e fluidez", "Proibir buzinas no carro", "Aumentar o n√∫mero de sem√°foros"], correct: 0, times: ["morning", "afternoon"] }
        ],
        leste: [
            { q: "Madrugada: Corridas clandestinas na via do hospital. Solu√ß√£o?", a: ["Radares e quebra-molas emborrachados", "Fechar a via permanentemente", "Colocar guardas armados"], correct: 0, times: ["dawn"] },
            { q: "Manh√£: Buzinas de motoristas impacientes no hospital. A√ß√£o?", a: ["Campanha 'Zona de Sil√™ncio' e multas", "Proibir carros perto de hospitais", "Aumentar o muro do hospital"], correct: 0, times: ["morning", "afternoon"] },
            { q: "Tarde: Ambul√¢ncias usando sirene em via livre. Solu√ß√£o?", a: ["Treinamento de condutores e protocolo", "Remover sirenes das ambul√¢ncias", "Multar o hospital"], correct: 0, times: ["afternoon"] }
        ],
        sul: [
            { q: "Noite: Som alto em quiosques da orla/parque. Solu√ß√£o?", a: ["Instalar limitadores de som travados", "Fechar os quiosques √†s 20h", "Aumentar o valor do aluguel"], correct: 0, times: ["night"] },
            { q: "Tarde: Manuten√ß√£o de jardins com sopradores ruidosos. A√ß√£o?", a: ["Substituir por equipamentos el√©tricos", "Parar a manuten√ß√£o do parque", "Usar apenas vassouras manuais"], correct: 0, times: ["afternoon"] }
        ]
    };

    function startGame() {
        document.getElementById('start-screen').style.display = 'none';
        state.gameActive = true;
        updateClock();
        gameTick();
    }

    function updateClock() {
        if (!state.gameActive) return;
        if (state.quizActive) {
            setTimeout(updateClock, 100);
            return;
        }

        state.minutes += 15;
        if (state.minutes >= 60) {
            state.minutes = 0;
            state.hours++;
            checkEvents();
        }
        if (state.hours >= 24) {
            state.hours = 0;
            state.days++;
            document.getElementById('days-val').innerText = "Dia " + state.days;
        }

        const h = state.hours.toString().padStart(2, '0');
        const m = state.minutes.toString().padStart(2, '0');
        document.getElementById('clock-val').innerText = `${h}:${m}`;

        let period = "Manh√£";
        if (state.hours >= 0 && state.hours < 6) period = "Madrugada";
        else if (state.hours >= 6 && state.hours < 12) period = "Manh√£";
        else if (state.hours >= 12 && state.hours < 18) period = "Tarde";
        else period = "Noite";
        document.getElementById('period-val').innerText = period;

        setTimeout(updateClock, HOUR_DURATION / 4);
    }

    function gameTick() {
        if (!state.gameActive || state.quizActive) {
            requestAnimationFrame(gameTick);
            return;
        }

        for (let r in state.regions) {
            let region = state.regions[r];
            if (region.event || region.quizAttempted) {
                if (region.db < region.targetDb) {
                    region.db = Math.min(region.targetDb, region.db + 0.08);
                }
            }

            const fill = document.getElementById(`db-${r}`);
            const marker = document.getElementById(`marker-${r}`);
            const card = document.getElementById(r);
            
            let displayWidth = ((region.db - region.base) / DEFEAT_THRESHOLD) * 100;
            fill.style.width = Math.max(5, displayWidth) + "%";
            
            if (region.db <= region.base + 5) fill.style.background = 'var(--success)';
            else if (region.db <= region.base + 12) fill.style.background = 'var(--warning)';
            else fill.style.background = 'var(--danger)';

            marker.style.display = (region.event && !region.quizAttempted) ? 'block' : 'none';
            card.className = 'region' + (region.db >= region.base + DEFEAT_THRESHOLD - 5 ? ' critical' : (region.event ? ' active-event' : ''));

            if (region.db >= region.base + DEFEAT_THRESHOLD) endGame(`A regi√£o ${r.toUpperCase()} excedeu o limite de seguran√ßa (+20dB)!`);
        }

        if (state.satisfaction <= 0) endGame("A popula√ß√£o se revoltou e voc√™ foi destitu√≠do do cargo!");

        requestAnimationFrame(gameTick);
    }

    function checkEvents() {
        if (Math.random() < 0.5) {
            const keys = Object.keys(state.regions);
            const randomRegion = keys[Math.floor(Math.random() * keys.length)];
            // BUG FIX: Agora permite novos eventos mesmo se quizAttempted for true, 
            // desde que n√£o haja um evento ATIVO no momento.
            if (!state.regions[randomRegion].event) {
                let timeCategory = "morning";
                if (state.hours >= 0 && state.hours < 6) timeCategory = "dawn";
                else if (state.hours >= 6 && state.hours < 12) timeCategory = "morning";
                else if (state.hours >= 12 && state.hours < 18) timeCategory = "afternoon";
                else timeCategory = "night";

                state.regions[randomRegion].event = true;
                state.regions[randomRegion].eventPeriod = timeCategory;
                state.regions[randomRegion].eventTime = EVENT_DURATION;
                state.regions[randomRegion].quizAttempted = false;
                state.regions[randomRegion].targetDb = state.regions[randomRegion].db + MAX_DB_INCREASE;
            }
        }

        for (let r in state.regions) {
            if (state.regions[r].event) {
                state.regions[r].eventTime--;
                if (state.regions[r].eventTime <= 0) {
                    state.regions[r].event = null;
                    // O quizAttempted √© resetado para permitir novas tentativas em futuros eventos
                    state.regions[r].quizAttempted = false; 
                }
            }
        }
    }

    function handleRegionClick(regionId) {
        if (!state.gameActive || state.quizActive) return;
        if (!state.regions[regionId].event || state.regions[regionId].quizAttempted) return;
        state.activeRegionId = regionId;
        showQuiz(regionId);
    }

    function showQuiz(regionId) {
        state.quizActive = true;
        const region = state.regions[regionId];
        const timeCategory = region.eventPeriod || "morning";
        const quizList = QUIZZES[regionId].filter(q => q.times.includes(timeCategory));
        const finalQuizList = quizList.length > 0 ? quizList : QUIZZES[regionId];
        const quiz = finalQuizList[Math.floor(Math.random() * finalQuizList.length)];
        
        document.getElementById('quiz-overlay').style.display = 'flex';
        document.getElementById('quiz-question').innerText = quiz.q;
        
        const optionsDiv = document.getElementById('quiz-options');
        optionsDiv.innerHTML = '';
        
        quiz.a.forEach((opt, idx) => {
            const btn = document.createElement('div');
            btn.className = 'quiz-option';
            btn.innerText = opt;
            btn.onclick = () => {
                state.regions[regionId].quizAttempted = true;
                let dbImpact = 0;
                let satImpact = 0;

                if (quiz.impacts && quiz.impacts[idx]) {
                    dbImpact = quiz.impacts[idx].db;
                    satImpact = quiz.impacts[idx].sat;
                } else {
                    if (idx === quiz.correct) {
                        dbImpact = -5;
                        satImpact = Math.floor(Math.random() * (8 - 4 + 1)) + 4;
                    } else {
                        dbImpact = 0;
                        satImpact = -(Math.floor(Math.random() * (18 - 12 + 1)) + 12);
                    }
                }
                
                state.satisfaction = Math.max(0, Math.min(100, state.satisfaction + satImpact));
                updateSatisfactionUI();

                if (dbImpact < 0) {
                    state.regions[regionId].db = Math.max(state.regions[regionId].base, state.regions[regionId].db + dbImpact);
                    state.regions[regionId].event = null;
                    state.regions[regionId].quizAttempted = false;
                } else {
                    if (dbImpact > 0) state.regions[regionId].db += dbImpact;
                    state.regions[regionId].event = null;
                }
                closeQuiz();
            };
            optionsDiv.appendChild(btn);
        });
    }

    function closeQuiz() {
        document.getElementById('quiz-overlay').style.display = 'none';
        state.quizActive = false;
    }

    function updateSatisfactionUI() {
        const val = document.getElementById('satisfaction-val');
        const fill = document.getElementById('satisfaction-fill');
        val.innerText = state.satisfaction + "%";
        fill.style.width = state.satisfaction + "%";
        if (state.satisfaction > 70) fill.style.background = 'var(--success)';
        else if (state.satisfaction > 30) fill.style.background = 'var(--warning)';
        else fill.style.background = 'var(--danger)';
    }

    function endGame(reason) {
        state.gameActive = false;
        document.getElementById('end-screen').style.display = 'flex';
        document.getElementById('end-reason').innerText = reason;
        document.getElementById('final-days').innerText = "Dia " + state.days;
    }
</script>
</body>
</html>
